<!-- Booking Modal -->
<div class="modal fade" id="booking-modal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="bookingModalLabel">Book Parking Space</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="create-booking-form">
                    <input type="hidden" id="selected-space-id">
                    <div class="mb-3">
                        <label for="license-plate" class="form-label">License Plate</label>
                        <div class="autocomplete-container">
                            <input type="text" class="form-control" id="license-plate" required autocomplete="off" placeholder="Enter license plate">
                            <div class="autocomplete-dropdown" id="license-plate-dropdown"></div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Book</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add User Modal -->
<div class="modal fade" id="add-user-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add New User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-user-form">
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="new-user-email" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="new-user-password" required>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="new-user-admin">
                            <label class="form-check-label">Admin User</label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Create User</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add OIDC Provider Modal -->
<div class="modal fade" id="add-oidc-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add OIDC Provider</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-oidc-form">
                    <div class="mb-3">
                        <label class="form-label">Display Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="new-oidc-display-name" required placeholder="e.g., Google, Microsoft, Company SSO">
                        <div class="form-text">User-friendly name shown on the login button</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Issuer <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="new-oidc-issuer" required placeholder="https://provider.example.com">
                        <div class="form-text">The OIDC provider's issuer URL (used internally)</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Client ID</label>
                        <input type="text" class="form-control" id="new-oidc-client-id" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Client Secret</label>
                        <input type="password" class="form-control" id="new-oidc-client-secret" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Well-known URL</label>
                        <input type="url" class="form-control" id="new-oidc-well-known" required placeholder="https://provider.example.com/.well-known/openid_configuration">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Scopes</label>
                        <input type="text" class="form-control" id="new-oidc-scopes" value="openid email profile">
                    </div>
                    <button type="submit" class="btn btn-primary">Create Provider</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Edit OIDC Provider Modal -->
<div class="modal fade" id="edit-oidc-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit OIDC Provider</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="edit-oidc-form">
                    <input type="hidden" id="edit-oidc-id">
                    <div class="mb-3">
                        <label class="form-label">Display Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="edit-oidc-display-name" required placeholder="e.g., Google, Microsoft, Company SSO">
                        <div class="form-text">User-friendly name shown on the login button</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Issuer <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="edit-oidc-issuer" required placeholder="https://provider.example.com">
                        <div class="form-text">The OIDC provider's issuer URL (used internally)</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Client ID</label>
                        <input type="text" class="form-control" id="edit-oidc-client-id" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Client Secret</label>
                        <input type="password" class="form-control" id="edit-oidc-client-secret">
                        <div class="form-text">Leave blank to keep current secret</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Well-known URL</label>
                        <input type="url" class="form-control" id="edit-oidc-well-known" required placeholder="https://provider.example.com/.well-known/openid_configuration">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Scopes</label>
                        <input type="text" class="form-control" id="edit-oidc-scopes" value="openid email profile">
                    </div>
                    <button type="submit" class="btn btn-primary">Update Provider</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add Parking Lot Modal -->
<div class="modal fade" id="add-parking-lot-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Parking Lot</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-parking-lot-form">
                    <div class="mb-3">
                        <label class="form-label">Name</label>
                        <input type="text" class="form-control" id="new-lot-name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Image URL</label>
                        <input type="url" class="form-control" id="new-lot-image" placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Or Upload Image</label>
                        <input type="file" class="form-control" id="new-lot-image-file" accept="image/*">
                    </div>
                    <button type="submit" class="btn btn-primary">Create Parking Lot</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add Parking Space Modal -->
<div class="modal fade" id="add-space-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Parking Space</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-space-form">
                    <div class="mb-3">
                        <label class="form-label">Space Number</label>
                        <input type="text" class="form-control" id="new-space-number" required>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Position X</label>
                                <input type="number" class="form-control" id="new-space-x" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Position Y</label>
                                <input type="number" class="form-control" id="new-space-y" required>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Width</label>
                                <input type="number" class="form-control" id="new-space-width" required value="100">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Height</label>
                                <input type="number" class="form-control" id="new-space-height" required value="50">
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Color</label>
                        <input type="color" class="form-control" id="new-space-color" value="#4CAF50">
                    </div>
                    <button type="submit" class="btn btn-primary">Create Space</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Context Menu for Visual Manager -->
<div id="admin-context-menu" class="context-menu">
    <div class="context-menu-item" data-action="edit">✏️ Edit Label</div>
    <div class="context-menu-item" data-action="clone">📋 Clone Space</div>
    <div class="context-menu-item" data-action="properties">⚙️ Properties</div>
    <div class="context-menu-item" data-action="delete">🗑️ Delete</div>
</div>

<!-- Edit Label Modal for Visual Manager -->
<div class="modal fade" id="admin-edit-label-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Space Label</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Space Number</label>
                    <input type="text" class="form-control" id="admin-edit-space-number" placeholder="e.g., A-01">
                </div>
                <div class="mb-3">
                    <label class="form-label">Space Color</label>
                    <input type="color" class="form-control" id="admin-edit-space-color">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="admin-save-label-changes">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Send Email Report Modal -->
<div class="modal fade" id="send-email-report-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Send Report via Email</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Recipients (comma-separated emails)</label>
                    <textarea class="form-control" id="email-report-recipients" rows="3" placeholder="admin@example.com, manager@example.com" required></textarea>
                    <div class="form-text">Enter one or more email addresses separated by commas</div>
                </div>
                <div class="mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="email-include-excel" checked>
                        <label class="form-check-label">Include Excel attachment</label>
                    </div>
                    <div class="form-text">When enabled, a detailed Excel report will be attached to the email</div>
                </div>
                <div class="alert alert-info">
                    <small>
                        <strong>Note:</strong> The report will include data for the currently selected time period and will be sent using the configured email settings.
                    </small>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="AdminReports.handleSendEmailReport()">Send Report</button>
            </div>
        </div>
    </div>
</div>

<!-- Add Claim Mapping Modal -->
<div class="modal fade" id="add-claim-mapping-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Claim Mapping</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-claim-mapping-form">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Claim Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="new-claim-name" required placeholder="e.g., email, department, roles">
                                <div class="form-text">The name of the claim in the OIDC token</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Mapped Field Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="new-mapped-field-name" required placeholder="e.g., user_email, department, admin_role">
                                <div class="form-text">Internal field name to store the claim value</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Mapping Type <span class="text-danger">*</span></label>
                                <select class="form-select" id="new-mapping-type" required>
                                    <option value="">Select Type</option>
                                    <option value="attribute">Attribute (Direct mapping)</option>
                                    <option value="role">Role (Admin access control)</option>
                                </select>
                                <div class="form-text">Choose how this claim should be processed</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Display Label <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="new-display-label" required placeholder="e.g., Email Address, Department">
                                <div class="form-text">Human-readable label for this mapping</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="new-is-required">
                            <label class="form-check-label">Required Claim</label>
                        </div>
                        <div class="form-text">If checked, authentication will fail if this claim is missing</div>
                    </div>

                    <div class="mb-3" id="role-admin-values-section" style="display: none;">
                        <label class="form-label">Admin Role Values</label>
                        <textarea class="form-control" id="new-role-admin-values" rows="3" placeholder="admin&#10;administrator&#10;superuser"></textarea>
                        <div class="form-text">Enter role values that grant admin access (one per line). Only applies to Role mappings.</div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Default Value</label>
                        <input type="text" class="form-control" id="new-default-value" placeholder="Default value if claim is missing">
                        <div class="form-text">Optional default value to use when the claim is not present</div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="new-description" rows="2" placeholder="Optional description of this mapping"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="AdminClaims.handleAddClaimMapping()">Create Mapping</button>
            </div>
        </div>
    </div>
</div>

<!-- Claims Discovery Modal -->
<div class="modal fade" id="claims-discovery-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Claims Discovery</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <strong>Instructions:</strong> Paste a sample OIDC token (JWT) from your provider below to discover available claims.
                    This will help you understand what data is available for mapping.
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Sample OIDC Token (JWT)</label>
                    <textarea class="form-control" id="sample-oidc-token" rows="8" placeholder="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9..."></textarea>
                    <div class="form-text">Paste the complete JWT token from your OIDC provider's response</div>
                </div>
                
                <div class="mb-3">
                    <button type="button" class="btn btn-primary" onclick="AdminClaims.handleDiscoverClaims()">🔍 Discover Claims</button>
                </div>

                <div id="discovery-results" style="display: none;">
                    <hr>
                    <h6>Discovery Results</h6>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">🔍 Discovered Claims</h6>
                                </div>
                                <div class="card-body">
                                    <div id="discovered-claims-list">
                                        <!-- Will be populated dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">⚠️ Unmapped Claims</h6>
                                </div>
                                <div class="card-body">
                                    <div id="unmapped-claims-list">
                                        <!-- Will be populated dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="card">
                            <div class="card-header">
                                <h6 class="mb-0">📋 Existing Mappings</h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>Claim</th>
                                                <th>Mapped Field</th>
                                                <th>Type</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody id="existing-mappings-table">
                                            <!-- Will be populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Claim Mapping Modal -->
<div class="modal fade" id="edit-claim-mapping-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Claim Mapping</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="edit-claim-mapping-form">
                    <input type="hidden" id="edit-claim-mapping-id">
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Claim Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="edit-claim-name" required>
                                <div class="form-text">The name of the claim in the OIDC token</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Mapped Field Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="edit-mapped-field-name" required>
                                <div class="form-text">Internal field name to store the claim value</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Mapping Type <span class="text-danger">*</span></label>
                                <select class="form-select" id="edit-mapping-type" required>
                                    <option value="attribute">Attribute (Direct mapping)</option>
                                    <option value="role">Role (Admin access control)</option>
                                </select>
                                <div class="form-text">Choose how this claim should be processed</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Display Label <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="edit-display-label" required>
                                <div class="form-text">Human-readable label for this mapping</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="edit-is-required">
                            <label class="form-check-label">Required Claim</label>
                        </div>
                        <div class="form-text">If checked, authentication will fail if this claim is missing</div>
                    </div>

                    <div class="mb-3" id="edit-role-admin-values-section">
                        <label class="form-label">Admin Role Values</label>
                        <textarea class="form-control" id="edit-role-admin-values" rows="3"></textarea>
                        <div class="form-text">Enter role values that grant admin access (one per line). Only applies to Role mappings.</div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Default Value</label>
                        <input type="text" class="form-control" id="edit-default-value">
                        <div class="form-text">Optional default value to use when the claim is not present</div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="edit-description" rows="2"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="AdminClaims.handleUpdateClaimMapping()">Update Mapping</button>
            </div>
        </div>
    </div>
</div>

<!-- Send Dynamic Report Modal -->
<div class="modal fade" id="send-dynamic-report-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">📧 Send Dynamic Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="modal-unified-email-form">
                    <!-- Template Selection -->
                    <div class="mb-3">
                        <label class="form-label">Report Template <span class="text-danger">*</span></label>
                        <select class="form-select" id="modal-unified-template-id" required>
                            <option value="">Select a template...</option>
                        </select>
                        <div class="form-text">Choose which report template to use</div>
                    </div>

                    <!-- Sending Method -->
                    <div class="mb-3">
                        <label class="form-label">How would you like to send this report?</label>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="modal-sending-method" id="modal-method-send-now" value="send_now" checked>
                                    <label class="form-check-label" for="modal-method-send-now">
                                        📧 Send Now
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="modal-sending-method" id="modal-method-schedule" value="schedule">
                                    <label class="form-check-label" for="modal-method-schedule">
                                        ⏰ Schedule
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="modal-sending-method" id="modal-method-test" value="test">
                                    <label class="form-check-label" for="modal-method-test">
                                        🧪 Send Test
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recipients Section -->
                    <div id="modal-recipients-section">
                        <!-- Send Now Recipients -->
                        <div class="mb-3" id="modal-send-now-recipients">
                            <label class="form-label">Recipients <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="modal-unified-recipients" rows="2" placeholder="user1@example.com, user2@example.com" required></textarea>
                            <div class="form-text">Enter email addresses separated by commas</div>
                        </div>

                        <!-- Test Email Recipient -->
                        <div class="mb-3" id="modal-test-email-recipient" style="display: none;">
                            <label class="form-label">Test Email Address <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="modal-unified-test-email" placeholder="test@example.com">
                            <div class="form-text">Single email address for testing</div>
                        </div>

                        <!-- Schedule Recipients -->
                        <div class="mb-3" id="modal-schedule-recipients" style="display: none;">
                            <label class="form-label">Scheduled Recipients <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="modal-unified-schedule-recipients" rows="2" placeholder="admin@example.com, manager@example.com"></textarea>
                            <div class="form-text">Recipients for scheduled reports</div>
                        </div>
                    </div>

                    <!-- Report Settings (for Send Now and Test) -->
                    <div id="modal-report-settings-section">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Report Period</label>
                                    <select class="form-select" id="modal-unified-report-months">
                                        <option value="1">Current Month</option>
                                        <option value="0">Last Month</option>
                                        <option value="2" selected>Last 2 Months</option>
                                        <option value="3">Last 3 Months</option>
                                        <option value="6">Last 6 Months</option>
                                        <option value="12">Last 12 Months</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <div class="form-check form-switch mt-4">
                                        <input class="form-check-input" type="checkbox" id="modal-unified-include-excel" checked>
                                        <label class="form-check-label">Include Excel Attachment</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Schedule Settings -->
                    <div id="modal-schedule-settings-section" style="display: none;">
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="modal-unified-schedule-enabled">
                                <label class="form-check-label">Enable Scheduled Reports</label>
                            </div>
                            <div class="form-text">Enable automatic report sending</div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Frequency</label>
                                    <select class="form-select" id="modal-unified-schedule-frequency">
                                        <option value="daily">Daily</option>
                                        <option value="weekly" selected>Weekly</option>
                                        <option value="monthly">Monthly</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Hour</label>
                                    <select class="form-select" id="modal-unified-schedule-hour">
                                        <option value="0">00:00</option>
                                        <option value="1">01:00</option>
                                        <option value="2">02:00</option>
                                        <option value="3">03:00</option>
                                        <option value="4">04:00</option>
                                        <option value="5">05:00</option>
                                        <option value="6">06:00</option>
                                        <option value="7">07:00</option>
                                        <option value="8">08:00</option>
                                        <option value="9" selected>09:00</option>
                                        <option value="10">10:00</option>
                                        <option value="11">11:00</option>
                                        <option value="12">12:00</option>
                                        <option value="13">13:00</option>
                                        <option value="14">14:00</option>
                                        <option value="15">15:00</option>
                                        <option value="16">16:00</option>
                                        <option value="17">17:00</option>
                                        <option value="18">18:00</option>
                                        <option value="19">19:00</option>
                                        <option value="20">20:00</option>
                                        <option value="21">21:00</option>
                                        <option value="22">22:00</option>
                                        <option value="23">23:00</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="form-label">Timezone</label>
                                    <select class="form-select" id="modal-unified-schedule-timezone">
                                        <option value="UTC" selected>UTC</option>
                                        <option value="Europe/Prague">Europe/Prague</option>
                                        <option value="America/New_York">America/New_York</option>
                                        <option value="America/Los_Angeles">America/Los_Angeles</option>
                                        <option value="Asia/Tokyo">Asia/Tokyo</option>
                                        <option value="Europe/London">Europe/London</option>
                                        <option value="Australia/Sydney">Australia/Sydney</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="modal-unified-action-btn" onclick="AdminDynamicReports.handleModalUnifiedEmailAction()">
                    📧 Send Now
                </button>
            </div>
        </div>
    </div>
</div>
